{% extends "base.html" %} {% block extra_css %}
<link
  rel="stylesheet"
  href="{{ url_for('static', filename='css/student_dashboard.css') }}"
/>
{% endblock %} {% block content %}
<div class="dashboard-container">
  <div class="card location-card">
    <h2>Your Bus Location</h2>
    <div id="map" style="height: 400px"></div>
  </div>
</div>
{% endblock %} {% block extra_js %}
<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyC77nilbjFldytx5doMTQ-Qf3EGp8Yg87c"></script>
<script>
  function initMap() {
    const map = new google.maps.Map(document.getElementById("map"), {
      center: { lat: 0, lng: 0 }, // Default center
      zoom: 15,
    });

    // Fetch the bus location for the student
    fetch(`/api/student-bus-location/${session["route_number"]}`)
      .then((response) => response.json())
      .then((data) => {
        const busLocation = data.location; // Current bus location

        // Set the map center to the bus location
        const busLatLng = { lat: busLocation.lat, lng: busLocation.lng };
        map.setCenter(busLatLng);
        new google.maps.Marker({
          position: busLatLng,
          map: map,
          title: "Bus Location",
        });
      });
  }

  initMap();
</script>
{% endblock %}
